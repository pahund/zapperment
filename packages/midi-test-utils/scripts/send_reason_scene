#!/usr/bin/env node

const { MidiInterface, ReasonController } = require("@zapperment/midi");
const { argv } = require("yargs");
const { initStrParameter, initJsonParameter } = require("./utils");
const { DEFAULT_PORT, DEFAULT_REASON_SCENE } = require("./constants");

const midiPortName = initStrParameter({
  name: "port",
  def: process.env.ZAPPERMENT_MIDI_PORT || DEFAULT_PORT,
  argv
});

const scene = initJsonParameter({
  name: "scene",
  def: DEFAULT_REASON_SCENE,
  argv
});

const midiInterface = new MidiInterface({ midiPortName });
const controller = new ReasonController({ midiInterface });
controller.changeScene(scene);
